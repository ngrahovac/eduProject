@page "/users/{UserId:int}"
@inject NavigationManager NavigationManager
@inject IAuthService AuthService
@inject ILocalStorageService LocalStorage

<style>
    body {
        padding-top: 7rem;
    }



    .container {
        margin-bottom: 60px;
    }

    .list-group {
        margin-bottom: 2rem;
    }


    .list-group-item-action:hover {
        background-color: rgba(0,0,0,.075);
    }

    .list-group-item-action.active {
        cursor: initial;
        background-color: #373a3c;
        border-color: #373a3c;
    }

    .spinner-border {
        width: 60px;
        height: 60px;
        text-align: center;
        top: 40%;
        position: absolute;
    }

    .btn-group {
        display: block;
    }

        .btn-group button:not(:last-child) {
            border-bottom: none;
        }
</style>


@if (ProfileDisplayModel == null)
{
<div class="d-flex justify-content-center">
    <div class="spinner-border text-info" role="status">
        <span class="sr-only"></span>
    </div>
</div> }
else
{
<div class="container">
    <div class="row">
        <div class="col">
            <div class="card" style="width: 18rem; background-color: rgba(0,0,0,.03);">
                <img src="@imgUrl" class="card-img-top" alt="Winston" />
                <div class="card-body">
                    <h5 class="card-title">@($"{ProfileDisplayModel.FirstName} {ProfileDisplayModel.LastName}")</h5>

                    <div class="card-text">
                        <div class="row ml-0">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
                                <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z" />
                            </svg>
                            @if (ProfileDisplayModel.UserAccountType == UserAccountType.Student)
                            {<h6 style="margin:5px 0px 0px 10px">@($"Student, {ProfileDisplayModel.FacultyName}")</h6> }
                            else
                            {<h6 style="margin:5px 0px 0px 10px; font-size:.7rem;">@($"{ProfileDisplayModel.AcademicRank.GetAttribute<DisplayAttribute>().Name}, {ProfileDisplayModel.FacultyName}")</h6>}
                        </div>
                        <div class="row ml-2">
                        </div>
                        <details style="margin-top:5px">
                            <summary>Opširnije</summary>
                            <div style="margin-left:15px">
                                @if (ProfileDisplayModel.UserAccountType == UserAccountType.Student)
                                {
                <small class="text-muted">Ciklus</small>
                                    <h6>@ProfileDisplayModel.Cycle</h6>
                                                        <small class="text-muted">Studijski program</small>
                                                                            <h6>@ProfileDisplayModel.StudyProgramName</h6>

                                                                                                @if (ProfileDisplayModel.StudyProgramSpecializationName != null)
                                                                                                {
                                                                            <small class="text-muted">Studijski smjer</small>
                                                                                                    <h6>@ProfileDisplayModel.StudyProgramSpecializationName</h6>
                                                                                                                            <small class="text-muted">Godina studija</small>
                                                                                                                                                    <h6>@ProfileDisplayModel.StudyYear</h6>} }
                                                                                            else
                                                                                            {
                                                                            <small class="text-muted">Fakultet</small>
                                                                                                <h6>@ProfileDisplayModel.FacultyName</h6>
                                                                                                                    <small class="text-muted">Uža naučna oblast</small>
                                                                                                                                        <h6>@ProfileDisplayModel.StudyFieldName</h6>}
                            </div>
                        </details>

                        <details>
                            <summary>Kontakt</summary>
                            <div style="margin-left:30px">
                                <div class="row" style="margin-top:5px">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-phone" viewBox="0 0 16 16">
                                        <path d="M11 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h6zM5 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H5z" />
                                        <path d="M8 14a1 1 0 1 0 0-2 1 1 0 0 0 0 2z" />
                                    </svg>
                                    @if (ProfileDisplayModel.PhoneNumberVisible && ProfileDisplayModel.PhoneNumber != null)
                                    {<h6 style="margin-left:5px">@ProfileDisplayModel.PhoneNumber</h6> }
                                else
                                {<h6 style="margin-left:5px">N/A</h6>}

                                </div>

                                <div class="row" style="margin-top:5px">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-globe" viewBox="0 0 16 16">
                                        <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm7.5-6.923c-.67.204-1.335.82-1.887 1.855A7.97 7.97 0 0 0 5.145 4H7.5V1.077zM4.09 4a9.267 9.267 0 0 1 .64-1.539 6.7 6.7 0 0 1 .597-.933A7.025 7.025 0 0 0 2.255 4H4.09zm-.582 3.5c.03-.877.138-1.718.312-2.5H1.674a6.958 6.958 0 0 0-.656 2.5h2.49zM4.847 5a12.5 12.5 0 0 0-.338 2.5H7.5V5H4.847zM8.5 5v2.5h2.99a12.495 12.495 0 0 0-.337-2.5H8.5zM4.51 8.5a12.5 12.5 0 0 0 .337 2.5H7.5V8.5H4.51zm3.99 0V11h2.653c.187-.765.306-1.608.338-2.5H8.5zM5.145 12c.138.386.295.744.468 1.068.552 1.035 1.218 1.65 1.887 1.855V12H5.145zm.182 2.472a6.696 6.696 0 0 1-.597-.933A9.268 9.268 0 0 1 4.09 12H2.255a7.024 7.024 0 0 0 3.072 2.472zM3.82 11a13.652 13.652 0 0 1-.312-2.5h-2.49c.062.89.291 1.733.656 2.5H3.82zm6.853 3.472A7.024 7.024 0 0 0 13.745 12H11.91a9.27 9.27 0 0 1-.64 1.539 6.688 6.688 0 0 1-.597.933zM8.5 12v2.923c.67-.204 1.335-.82 1.887-1.855.173-.324.33-.682.468-1.068H8.5zm3.68-1h2.146c.365-.767.594-1.61.656-2.5h-2.49a13.65 13.65 0 0 1-.312 2.5zm2.802-3.5a6.959 6.959 0 0 0-.656-2.5H12.18c.174.782.282 1.623.312 2.5h2.49zM11.27 2.461c.247.464.462.98.64 1.539h1.835a7.024 7.024 0 0 0-3.072-2.472c.218.284.418.598.597.933zM10.855 4a7.966 7.966 0 0 0-.468-1.068C9.835 1.897 9.17 1.282 8.5 1.077V4h2.355z" />
                                    </svg>
                                    @if (ProfileDisplayModel.Website != null)
                                    {<h6 style="margin-left:5px"><a href="@ProfileDisplayModel.Website" class="text-reset">@ProfileDisplayModel.Website</a></h6> }
                                else
                                {<h6 style="margin-left:5px">N/A</h6>}
                                </div>

                                <div class="row" style="margin-top:5px">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chat-square" viewBox="0 0 16 16">
                                        <path d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1h-2.5a2 2 0 0 0-1.6.8L8 14.333 6.1 11.8a2 2 0 0 0-1.6-.8H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h2.5a1 1 0 0 1 .8.4l1.9 2.533a1 1 0 0 0 1.6 0l1.9-2.533a1 1 0 0 1 .8-.4H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
                                    </svg>
                                    @if (ProfileDisplayModel.EmailVisible)
                                    {<h6 style="margin-left:5px"><a class="text-reset">@ProfileDisplayModel.Email</a></h6> }
                                else
                                {<h6 style="margin-left:5px">N/A</h6>}
                                </div>

                                <div class="row" style="margin-top:5px">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-linkedin" viewBox="0 0 16 16">
                                        <path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z" />
                                    </svg>
                                    @if (ProfileDisplayModel.LinkedinProfile != null)
                                    {<h6 style="margin-left:5px"><a href="#" class="text-reset">@ProfileDisplayModel.LinkedinProfile</a></h6> }
                                else
                                {<h6 style="margin-left:5px">N/A</h6>}
                                </div>

                                <div class="row" style="margin-top:5px">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-suit-heart" viewBox="0 0 16 16">
                                        <path d="M8 6.236l-.894-1.789c-.222-.443-.607-1.08-1.152-1.595C5.418 2.345 4.776 2 4 2 2.324 2 1 3.326 1 4.92c0 1.211.554 2.066 1.868 3.37.337.334.721.695 1.146 1.093C5.122 10.423 6.5 11.717 8 13.447c1.5-1.73 2.878-3.024 3.986-4.064.425-.398.81-.76 1.146-1.093C14.446 6.986 15 6.131 15 4.92 15 3.326 13.676 2 12 2c-.777 0-1.418.345-1.954.852-.545.515-.93 1.152-1.152 1.595L8 6.236zm.392 8.292a.513.513 0 0 1-.784 0c-1.601-1.902-3.05-3.262-4.243-4.381C1.3 8.208 0 6.989 0 4.92 0 2.755 1.79 1 4 1c1.6 0 2.719 1.05 3.404 2.008.26.365.458.716.596.992a7.55 7.55 0 0 1 .596-.992C9.281 2.049 10.4 1 12 1c2.21 0 4 1.755 4 3.92 0 2.069-1.3 3.288-3.365 5.227-1.193 1.12-2.642 2.48-4.243 4.38z" />
                                    </svg>
                                    @if (ProfileDisplayModel.ResearchgateProfile != null)
                                    {<h6 style="margin-left:5px"><a href="#" class="text-reset">@ProfileDisplayModel.ResearchgateProfile</a></h6> }
                                else
                                {<h6 style="margin-left:5px">N/A</h6>}
                                </div>
                            </div>
                        </details>

                        <details>
                            <summary>O meni</summary>
                            <div style="margin-left:15px">
                                @if (ProfileDisplayModel.Bio != null)
                                {<p>@ProfileDisplayModel.Bio</p> }
                            else
                            {<p>N/A</p>}
                            </div>
                        </details>
                    </div>
                </div>
            </div>

            @if (ProfileDisplayModel.IsDisplayPersonal == true)
            {
<div class="btn-group">

    <a class="btn btn-outline-info" style="margin-top:5px;" @onclick="@(async () =>
                                                              {
                                                                  NavigationManager.NavigateTo($"/users/{await LocalStorage.ExtractUserId()}/applications", true);})">Moje prijave</a>

    <a class="btn btn-outline-info" style="margin-top:5px;" @onclick="@(() => NavigationManager.NavigateTo($"/users/{UserId}/settings", true))">Opcije</a>

    <a class="btn btn-outline-primary" type="submit" @onclick="@(async () =>
                                                                      {
                                                                  await AuthService.Logout();
                                                                  NavigationManager.NavigateTo("/account/login");
                                                              })" style="margin-top:5px;">Odjavi se</a>
</div>          }




        </div>

        <div class="col-md-8">
            @* col-md-8 *@
            @if (ProfileDisplayModel.AuthoredProjectDisplayModels.Count() > 0)
            {
<div class="list-group">
    <a class="list-group-item list-group-item-action active">Oglašeni projekti</a>
    @foreach (var p in ProfileDisplayModel.AuthoredProjectDisplayModels)
    {<a class="list-group-item list-group-item-action" href=@($"{NavigationManager.BaseUri}projects/{p.ProjectId}")>@(p.Title)</a>}
</div> }
else
{<a class="list-group-item list-group-item-action disabled">Nema oglašenih projekata</a>}

            @if (ProfileDisplayModel.ProjectCollaborationsDisplayModels.Count() > 0)
            {
<div class="list-group">
    <a href="#" class="list-group-item list-group-item-action active">Saradnje na projektima</a>
    @foreach (var p in ProfileDisplayModel.ProjectCollaborationsDisplayModels)
    {<a class="list-group-item list-group-item-action" href=@($"{NavigationManager.BaseUri}projects/{p.ProjectId}")>@(p.Title)</a>}
</div> }
else
{<a class="list-group-item list-group-item-action disabled">Nema saradnje na projektima</a>}
        </div>
    </div>
</div>}







